<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warehouse Hub - –°–∏—Å—Ç–µ–º–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –°–∫–ª–∞–¥–æ–º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –ö–∞—Å—Ç–æ–º–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –∫–æ–ª—å–æ—Ä–æ–≤–æ—ó –ø–∞–ª—ñ—Ç—Ä–∏ */
        .sidebar {
            background-color: #1E3A8A; /* Primary Dark Blue */
        }
        .text-accent {
            color: #10B981; /* Accent Green */
        }
        .bg-accent-light {
            background-color: #D1FAE5;
        }
        .bg-low-stock {
            background-color: #FEF3C7; /* Light Yellow for low stock warning */
        }
        .active-link {
            background-color: #254F9D; /* Slightly lighter shade for active link */
            border-left: 4px solid #10B981;
        }
    </style>
</head>

<body class="bg-gray-50 flex min-h-screen">

    <div id="auth-screen" class="fixed inset-0 bg-gray-900 bg-opacity-95 z-50 flex items-center justify-center">
        <div class="w-full max-w-md p-8 space-y-6 bg-white shadow-2xl rounded-xl">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-gray-900">üì¶ Warehouse Hub –í—Ö—ñ–¥</h2>
            </div>

            <div class="flex border rounded-lg overflow-hidden">
                <button id="show-login-btn" class="flex-1 py-2 font-medium text-white bg-blue-800 hover:bg-blue-700 transition duration-150">–í—Ö—ñ–¥</button>
                <button id="show-register-btn" class="flex-1 py-2 font-medium text-gray-700 bg-gray-200 hover:bg-gray-300 transition duration-150">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
            </div>

            <form id="login-form" class="space-y-4" onsubmit="handleLogin(event)">
                <input type="email" id="login-email" name="email" required class="w-full p-2 border rounded" placeholder="Email (–õ–æ–≥—ñ–Ω)">
                <input type="password" id="login-password" name="password" required class="w-full p-2 border rounded" placeholder="–ü–∞—Ä–æ–ª—å">
                <button type="submit" class="w-full py-2 px-4 rounded-md text-sm font-medium text-white bg-blue-800 hover:bg-blue-700">
                    –£–≤—ñ–π—Ç–∏
                </button>
            </form>

            <form id="register-form" class="space-y-4 hidden" onsubmit="handleRegister(event)">
                <input type="text" id="reg-username" name="username" required class="w-full p-2 border rounded" placeholder="–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞">
                <input type="email" id="reg-email" name="email" required class="w-full p-2 border rounded" placeholder="Email (–õ–æ–≥—ñ–Ω)">
                <input type="password" id="reg-password" name="password" required class="w-full p-2 border rounded" placeholder="–ü–∞—Ä–æ–ª—å">
                <button type="submit" class="w-full py-2 px-4 rounded-md text-sm font-medium text-white bg-accent hover:bg-green-600">
                    –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è
                </button>
            </form>

            <p id="auth-message" class="text-center text-sm text-gray-600"></p>
        </div>
    </div>

<aside class="sidebar w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition duration-200 ease-in-out">
    <div class="text-white text-2xl font-bold ml-4">üì¶ Warehouse Hub</div>

    <nav id="nav-menu">
        <a href="#products" class="nav-link block py-2.5 px-4 rounded transition duration-200 text-white hover:bg-[#254F9D] flex items-center active-link" data-section="products">
            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h3"></path></svg>
            –¢–æ–≤–∞—Ä–∏
        </a>
        <a href="#movements" class="nav-link block py-2.5 px-4 rounded transition duration-200 text-white hover:bg-[#254F9D] flex items-center" data-section="movements">
            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
            –†—É—Ö
        </a>
        <a href="#invoices" class="nav-link block py-2.5 px-4 rounded transition duration-200 text-white hover:bg-[#254F9D] flex items-center" data-section="invoices">
            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
            –ù–∞–∫–ª–∞–¥–Ω—ñ
        </a>
        <a href="#reports" class="nav-link block py-2.5 px-4 rounded transition duration-200 text-white hover:bg-[#254F9D] flex items-center" data-section="reports">
            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path></svg>
            –ó–≤—ñ—Ç–∏
        </a>
        <a href="#suppliers" class="nav-link block py-2.5 px-4 rounded transition duration-200 text-white hover:bg-[#254F9D] flex items-center" data-section="suppliers">
            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
            –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∏
        </a>
        <a href="#notifications" class="nav-link block py-2.5 px-4 rounded transition duration-200 text-white hover:bg-[#254F9D] flex items-center" data-section="notifications">
            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
            –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è
        </a>
    </nav>
</aside>

<div class="flex-1 flex flex-col">
    <header class="bg-white shadow p-4 flex justify-between items-center sticky top-0 z-10">
        <h1 id="page-title" class="text-xl font-semibold text-gray-800">–¢–æ–≤–∞—Ä–∏</h1>
        <button id="notification-button" class="relative p-2 rounded-full hover:bg-gray-100 transition duration-150" onclick="showNotifications()">
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
            <span id="unread-count" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full">0</span>
        </button>
    </header>

    <main class="p-6 space-y-6">
        <div id="products-section" class="content-section">
            <div class="flex justify-between items-center mb-4">
                <button onclick="openModal('createProductModal')"
                        class="bg-blue-800 text-white py-2 px-4 rounded hover:bg-accent transition duration-200 flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                    –°—Ç–≤–æ—Ä–∏—Ç–∏ –¢–æ–≤–∞—Ä
                </button>
                <div class="flex space-x-4">
                    <input type="text" id="article-search" placeholder="–ü–æ—à—É–∫ –∑–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–º..." class="p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button onclick="searchProductByArticle()" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200">–ó–Ω–∞–π—Ç–∏</button>
                    <button onclick="loadProducts(true)" class="bg-yellow-600 text-white py-2 px-4 rounded hover:bg-yellow-700 transition duration-200">–ù–∏–∑—å–∫–∏–π –ó–∞–ø–∞—Å</button>
                </div>
            </div>

            <div class="bg-white shadow-lg rounded-lg p-4">
                <h3 class="text-lg font-medium mb-4">–ü–æ—Ç–æ—á–Ω–∏–π –ó–∞–ø–∞—Å</h3>
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ù–∞–∑–≤–∞</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ê—Ä—Ç–∏–∫—É–ª</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ú—ñ–Ω. –ó–∞–ø–∞—Å</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–î—ñ—ó</th>
                    </tr>
                    </thead>
                    <tbody id="products-list" class="bg-white divide-y divide-gray-200">
                    <tr><td colspan="5" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="movements-section" class="content-section hidden">
            <div class="flex space-x-4 mb-4">
                <button onclick="openMovementModal('arrival')" class="bg-accent text-white py-2 px-4 rounded hover:bg-green-600 transition duration-200">‚ûï –ù–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è</button>
                <button onclick="openMovementModal('shipment')" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200">‚ûñ –í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</button>
                <button onclick="openMovementModal('writeoff')" class="bg-orange-600 text-white py-2 px-4 rounded hover:bg-orange-700 transition duration-200">‚ùå –°–ø–∏—Å–∞–Ω–Ω—è</button>
                <div class="flex ml-auto space-x-2">
                    <input type="datetime-local" id="movement-start-date" class="p-2 border border-gray-300 rounded">
                    <input type="datetime-local" id="movement-end-date" class="p-2 border border-gray-300 rounded">
                    <button onclick="loadMovementsByDateRange()" class="bg-gray-600 text-white py-2 px-4 rounded hover:bg-gray-700 transition duration-200">–§—ñ–ª—å—Ç—Ä</button>
                </div>
            </div>
            <div class="bg-white shadow-lg rounded-lg p-4">
                <h3 class="text-lg font-medium mb-4">–Ü—Å—Ç–æ—Ä—ñ—è –†—É—Ö—É –¢–æ–≤–∞—Ä—ñ–≤</h3>
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–î–∞—Ç–∞</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–¢–∏–ø</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ü—Ä–æ–¥—É–∫—Ç ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–û–ø–∏—Å</th>
                    </tr>
                    </thead>
                    <tbody id="movements-list" class="bg-white divide-y divide-gray-200">
                    <tr><td colspan="5" class="p-4 text-center text-gray-500">–û–±–µ—Ä—ñ—Ç—å –ø–µ—Ä—ñ–æ–¥ –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="invoices-section" class="content-section hidden">
            <button onclick="openModal('shipmentRequestModal')" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200 mb-4">
                –ü—Ä–æ–≤–µ—Å—Ç–∏ –ö–æ–º–ø–ª–µ–∫—Å–Ω–µ –í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (Invoice)
            </button>
            <div class="bg-white shadow-lg rounded-lg p-4">
                <h3 class="text-lg font-medium mb-4">–°–ø–∏—Å–æ–∫ –ù–∞–∫–ª–∞–¥–Ω–∏—Ö</h3>
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–î–∞—Ç–∞</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–°—Ç–∞—Ç—É—Å</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–î—ñ—ó</th>
                    </tr>
                    </thead>
                    <tbody id="invoices-list" class="bg-white divide-y divide-gray-200">
                    <tr><td colspan="5" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="reports-section" class="content-section hidden">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <button onclick="loadReport('warehouse-status')" class="bg-gray-700 text-white p-4 rounded-lg hover:bg-gray-800 transition duration-200">–°–∫–ª–∞–¥ (Status)</button>
                <button onclick="loadReport('financial-summary')" class="bg-gray-700 text-white p-4 rounded-lg hover:bg-gray-800 transition duration-200">–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π (Summary)</button>
                <button onclick="loadReport('full-warehouse')" class="bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 transition duration-200">–ü–æ–≤–Ω–∏–π –°–∫–ª–∞–¥ (Facade)</button>
                <button onclick="openModal('reportGeneratorModal')" class="bg-accent text-white p-4 rounded-lg hover:bg-green-600 transition duration-200">–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –ó–≤—ñ—Ç (Builder)</button>
            </div>
            <div class="bg-white shadow-lg rounded-lg p-6">
                <h3 class="text-xl font-medium mb-4 text-gray-800">–†–µ–∑—É–ª—å—Ç–∞—Ç –ó–≤—ñ—Ç—É</h3>
                <pre id="report-output" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto text-gray-700">–û–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –∑–≤—ñ—Ç—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∞–±–æ —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—å —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º.</pre>
            </div>
        </div>

        <div id="notifications-section" class="content-section hidden">
            <div class="bg-white shadow-lg rounded-lg p-4">
                <h3 class="text-lg font-medium mb-4">–£—Å—ñ –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</h3>
                <ul id="notifications-list" class="divide-y divide-gray-200">
                    <li class="p-3 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å...</li>
                </ul>
            </div>
        </div>

        <div id="suppliers-section" class="content-section hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞–º–∏</h2>
                <button onclick="openModal('createSupplierModal')" class="bg-blue-800 text-white py-2 px-4 rounded hover:bg-accent transition duration-200 flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                    –î–æ–¥–∞—Ç–∏ –ù–æ–≤–æ–≥–æ –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞
                </button>
            </div>

            <div class="bg-white shadow-lg rounded-lg p-4">
                <h3 class="text-lg font-medium mb-4">–°–ø–∏—Å–æ–∫ –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤</h3>
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ù–∞–∑–≤–∞</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ö–æ–Ω—Ç–∞–∫—Ç</th>
                    </tr>
                    </thead>
                    <tbody id="suppliers-list" class="bg-white divide-y divide-gray-200">
                    <tr><td colspan="3" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</div>

<div id="createSupplierModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <h3 class="text-lg font-bold mb-4">–°—Ç–≤–æ—Ä–∏—Ç–∏ –ù–æ–≤–æ–≥–æ –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞</h3>
        <form id="create-supplier-form" onsubmit="handleCreateSupplier(event)">
            <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞ –ö–æ–º–ø–∞–Ω—ñ—ó" required class="w-full p-2 mb-3 border rounded">
            <input type="text" name="contactPerson" placeholder="–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞ –û—Å–æ–±–∞" required class="w-full p-2 mb-3 border rounded">
            <input type="email" name="email" placeholder="Email" class="w-full p-2 mb-3 border rounded">
            <input type="text" name="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" class="w-full p-2 mb-3 border rounded">

            <div class="flex justify-end space-x-2 mt-4">
                <button type="button" onclick="closeModal('createSupplierModal')" class="px-4 py-2 text-gray-600 bg-gray-200 rounded hover:bg-gray-300">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button type="submit" class="px-4 py-2 bg-accent text-white rounded hover:bg-green-600">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </form>
    </div>
</div>

<div id="createProductModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <h3 class="text-lg font-bold mb-4">–°—Ç–≤–æ—Ä–∏—Ç–∏ –ù–æ–≤–∏–π –¢–æ–≤–∞—Ä</h3>
        <form id="create-product-form" onsubmit="handleCreateProduct(event)">
            <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞" required class="w-full p-2 mb-3 border rounded">
            <input type="text" name="article" placeholder="–ê—Ä—Ç–∏–∫—É–ª" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="price" placeholder="–¶—ñ–Ω–∞ (0.00)" step="0.01" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="supplierId" placeholder="ID –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="minQuantity" placeholder="–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ó–∞–ø–∞—Å (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: 10)" class="w-full p-2 mb-3 border rounded">
            <input type="number" name="initialQuantity" placeholder="–ü–æ—á–∞—Ç–∫–æ–≤–∞ –ö—ñ–ª—å–∫—ñ—Å—Ç—å (–Ω–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è)" class="w-full p-2 mb-3 border rounded">

            <div class="flex justify-end space-x-2 mt-4">
                <button type="button" onclick="closeModal('createProductModal')" class="px-4 py-2 text-gray-600 bg-gray-200 rounded hover:bg-gray-300">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button type="submit" class="px-4 py-2 bg-accent text-white rounded hover:bg-green-600">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </form>
    </div>
</div>

<div id="movementModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <h3 id="movement-modal-title" class="text-lg font-bold mb-4">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –†—É—Ö—É</h3>
        <form id="movement-form" onsubmit="handleMovement(event)">
            <input type="hidden" id="movement-type">
            <input type="number" name="productId" placeholder="ID –ü—Ä–æ–¥—É–∫—Ç—É" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="quantity" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="userId" placeholder="ID –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (1)" value="1" required class="w-full p-2 mb-3 border rounded">

            <input type="text" id="movement-description-input" name="description" placeholder="–û–ø–∏—Å / –ü—Ä–∏—á–∏–Ω–∞" required class="w-full p-2 mb-3 border rounded">

            <div class="flex justify-end space-x-2 mt-4">
                <button type="button" onclick="closeModal('movementModal')" class="px-4 py-2 text-gray-600 bg-gray-200 rounded hover:bg-gray-300">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button type="submit" class="px-4 py-2 bg-accent text-white rounded hover:bg-green-600">–í–∏–∫–æ–Ω–∞—Ç–∏</button>
            </div>
        </form>
    </div>
</div>

<div id="shipmentRequestModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-10 mx-auto p-6 border w-2/5 shadow-lg rounded-md bg-white">
        <h3 class="text-lg font-bold mb-4">–ö–æ–º–ø–ª–µ–∫—Å–Ω–µ –í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (Invoice)</h3>
        <form id="shipment-request-form" onsubmit="handleProcessShipment(event)">
            <input type="number" name="contractorId" placeholder="ID –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="userId" placeholder="ID –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (1)" value="1" required class="w-full p-2 mb-3 border rounded">

            <h4 class="font-semibold mt-4 mb-2">–¢–æ–≤–∞—Ä–∏ –¥–ª—è –í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h4>
            <div id="shipment-items-container" class="space-y-2 border p-3 rounded bg-gray-50">
                <div class="flex space-x-2">
                    <input type="number" name="productId" placeholder="ID –ü—Ä–æ–¥—É–∫—Ç—É" class="flex-1 p-2 border rounded">
                    <input type="number" name="quantity" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å" class="w-24 p-2 border rounded">
                </div>
            </div>
            <button type="button" onclick="addShipmentItem()" class="mt-2 text-blue-600 hover:text-blue-800 flex items-center">
                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                –î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä
            </button>

            <div class="flex justify-end space-x-2 mt-6">
                <button type="button" onclick="closeModal('shipmentRequestModal')" class="px-4 py-2 text-gray-600 bg-gray-200 rounded hover:bg-gray-300">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">–ü—Ä–æ–≤–µ—Å—Ç–∏ –í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</button>
            </div>
        </form>
    </div>
</div>

<div id="editProductModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <h3 class="text-lg font-bold mb-4">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –¢–æ–≤–∞—Ä</h3>
        <form id="edit-product-form" onsubmit="handleUpdateProduct(event)">
            <input type="hidden" id="edit-product-id" name="id">

            <input type="text" name="name" id="edit-name" placeholder="–ù–∞–∑–≤–∞" required class="w-full p-2 mb-3 border rounded">
            <input type="text" name="article" id="edit-article" placeholder="–ê—Ä—Ç–∏–∫—É–ª" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="price" id="edit-price" placeholder="–¶—ñ–Ω–∞ (0.00)" step="0.01" required class="w-full p-2 mb-3 border rounded">
            <input type="number" name="minQuantity" id="edit-minQuantity" placeholder="–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ó–∞–ø–∞—Å" class="w-full p-2 mb-3 border rounded">
            <input type="number" name="supplierId" id="edit-supplierId" placeholder="ID –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞" class="w-full p-2 mb-3 border rounded">

            <div class="flex justify-end space-x-2 mt-4">
                <button type="button" onclick="closeModal('editProductModal')" class="px-4 py-2 text-gray-600 bg-gray-200 rounded hover:bg-gray-300">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">–ó–±–µ—Ä–µ–≥—Ç–∏ –ó–º—ñ–Ω–∏</button>
            </div>
        </form>
    </div>
</div>

<div id="reportGeneratorModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <h3 class="text-lg font-bold mb-4">–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ó–≤—ñ—Ç—ñ–≤</h3>
        <form id="report-generator-form" onsubmit="handleGenerateReport(event)">
            <select name="reportType" required class="w-full p-2 mb-3 border rounded">
                <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –∑–≤—ñ—Ç—É</option>
                <option value="WAREHOUSE_STATUS">–°—Ç–∞–Ω –°–∫–ª–∞–¥—É</option>
                <option value="MOVEMENT_DYNAMICS">–î–∏–Ω–∞–º—ñ–∫–∞ –†—É—Ö—É</option>
                <option value="FINANCIAL_SUMMARY">–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –ó–≤—ñ—Ç</option>
            </select>
            <label class="block text-sm font-medium text-gray-700 mb-1 mt-3">–ü–æ—á–∞—Ç–∫–æ–≤–∞ –î–∞—Ç–∞ (–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)</label>
            <input type="datetime-local" name="startDate" class="w-full p-2 mb-3 border rounded">
            <label class="block text-sm font-medium text-gray-700 mb-1">–ö—ñ–Ω—Ü–µ–≤–∞ –î–∞—Ç–∞ (–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)</label>
            <input type="datetime-local" name="endDate" class="w-full p-2 mb-3 border rounded">

            <div class="flex justify-end space-x-2 mt-4">
                <button type="button" onclick="closeModal('reportGeneratorModal')" class="px-4 py-2 text-gray-600 bg-gray-200 rounded hover:bg-gray-300">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button type="submit" class="px-4 py-2 bg-accent text-white rounded hover:bg-green-600">–ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
            </div>
        </form>
    </div>
</div>

<script>
    // API Base URL (–ó–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Å–≤—ñ–π —Ä–µ–∞–ª—å–Ω–∏–π)
    const API_BASE_URL = 'http://localhost:8080/api';
    const AUTH_API_URL = 'http://localhost:8080/api/auth';

    // --- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ù–∞–≤—ñ–≥–∞—Ü—ñ—î—é —Ç–∞ –°–µ–∫—Ü—ñ—è–º–∏ ---
    document.addEventListener('DOMContentLoaded', () => {
        checkAuthStatus();
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.content-section');

        const switchSection = (sectionId) => {
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–ª–∞—Å—É –≤ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó
            navLinks.forEach(link => {
                link.classList.remove('active-link');
                if (link.getAttribute('data-section') === sectionId) {
                    link.classList.add('active-link');
                }
            });

            // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ —Å–µ–∫—Ü—ñ–π
            sections.forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId + '-section').classList.remove('hidden');

            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
            document.getElementById('page-title').textContent = document.querySelector(`.nav-link[data-section="${sectionId}"]`).textContent.trim();

            // –ó–∞–ø—É—Å–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—ó —Å–µ–∫—Ü—ñ—ó
            if (sectionId === 'products') loadProducts();
            if (sectionId === 'invoices') loadInvoices();
            if (sectionId === 'notifications') loadNotifications();
            if (sectionId === 'suppliers') loadSuppliers();
        };

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                switchSection(e.currentTarget.getAttribute('data-section'));
            });
        });

        switchSection('products');
        loadUnreadCount();

        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const showLoginBtn = document.getElementById('show-login-btn');
        const showRegisterBtn = document.getElementById('show-register-btn');

        showLoginBtn.addEventListener('click', () => {
            loginForm.classList.remove('hidden');
            registerForm.classList.add('hidden');
            showLoginBtn.classList.add('bg-blue-800', 'text-white');
            showLoginBtn.classList.remove('bg-gray-200', 'text-gray-700');
            showRegisterBtn.classList.remove('bg-blue-800', 'text-white');
            showRegisterBtn.classList.add('bg-gray-200', 'text-gray-700');
            document.getElementById('auth-message').textContent = '';
        });

        showRegisterBtn.addEventListener('click', () => {
            registerForm.classList.remove('hidden');
            loginForm.classList.add('hidden');
            showRegisterBtn.classList.add('bg-blue-800', 'text-white');
            showRegisterBtn.classList.remove('bg-gray-200', 'text-gray-700');
            showLoginBtn.classList.remove('bg-blue-800', 'text-white');
            showLoginBtn.classList.add('bg-gray-200', 'text-gray-700');
            document.getElementById('auth-message').textContent = '';
        });
    });

    async function handleRegister(event) {
        event.preventDefault();
        const form = event.target;
        const authMessage = document.getElementById('auth-message');
        authMessage.textContent = '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è...';

        const data = {
            username: form.username.value,
            email: form.email.value,
            password: form.password.value,
            role: "USER"
        };

        try {
            const response = await fetch(`${AUTH_API_URL}/register`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await response.json();

            if (response.ok) {
                authMessage.className = 'text-center text-sm text-accent';
                authMessage.textContent = '‚úÖ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! –¢–µ–ø–µ—Ä —É–≤—ñ–π–¥—ñ—Ç—å.';
                // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –Ω–∞ —Ñ–æ—Ä–º—É –≤—Ö–æ–¥—É
                document.getElementById('show-login-btn').click();
            } else {
                authMessage.className = 'text-center text-sm text-red-600';
                authMessage.textContent = `–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó: ${result.message || response.statusText}`;
            }
        } catch (error) {
            authMessage.className = 'text-center text-sm text-red-600';
            authMessage.textContent = '–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ –∞–±–æ —Å–µ—Ä–≤–µ—Ä–∞.';
            console.error(error);
        }
    }

    async function handleLogin(event) {
        event.preventDefault();
        const form = event.target;
        const authMessage = document.getElementById('auth-message');
        authMessage.textContent = '–í—Ö—ñ–¥...';

        const data = {
            email: form.email.value,
            password: form.password.value,
        };

        try {
            const response = await fetch(`${AUTH_API_URL}/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const result = await response.json();

                localStorage.setItem('userId', result.userId);

                authMessage.className = 'text-center text-sm text-accent';
                authMessage.textContent = '‚úÖ –í—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π!';

                checkAuthStatus();
                loadProducts();
            } else {
                authMessage.className = 'text-center text-sm text-red-600';
                authMessage.textContent = `–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É: –ù–µ–≤—ñ—Ä–Ω–∏–π email –∞–±–æ –ø–∞—Ä–æ–ª—å.`;
            }
        } catch (error) {
            authMessage.className = 'text-center text-sm text-red-600';
            authMessage.textContent = '–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ –∞–±–æ —Å–µ—Ä–≤–µ—Ä–∞.';
            console.error(error);
        }
    }

    function getUserId() {
        return localStorage.getItem('userId');
    }

    function checkAuthStatus() {
        const userId = getUserId();
        const authScreen = document.getElementById('auth-screen');

        if (userId) {
            // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–≤—ñ–π—à–æ–≤, –ø—Ä–∏—Ö–æ–≤—É—î–º–æ –µ–∫—Ä–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
            if (authScreen) authScreen.classList.add('hidden');
            console.log(`–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥. ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: ${userId}`);
        } else {
            // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ —É–≤—ñ–π—à–æ–≤, –ø–æ–∫–∞–∑—É—î–º–æ –µ–∫—Ä–∞–Ω
            if (authScreen) authScreen.classList.remove('hidden');
            console.log("–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ —É–≤—ñ–π—à–æ–≤. –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω—É –≤—Ö–æ–¥—É.");
        }
    }

    function handleLogout() {
        localStorage.removeItem('userId');
        checkAuthStatus();
        // –î–æ–¥–∞—Ç–∫–æ–≤–æ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É
        window.location.reload();
    }

    function openEditProductModal(id) {
        // 1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç—É (GET /api/products/{id})
        fetch(`${API_BASE_URL}/products/${id}`)
            .then(res => {
                if (!res.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ–¥—É–∫—Ç—É.');
                return res.json();
            })
            .then(product => {
                // 2. –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Ñ–æ—Ä–º—É –¥–∞–Ω–∏–º–∏
                document.getElementById('edit-product-id').value = product.id;
                document.getElementById('edit-name').value = product.name;
                document.getElementById('edit-article').value = product.article;
                document.getElementById('edit-price').value = product.price;
                document.getElementById('edit-minQuantity').value = product.minQuantity;
                // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ supplierId –¥–æ—Å—Ç—É–ø–Ω–∏–π –∞–±–æ –º–æ–∂–µ –±—É—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π
                // –Ø–∫—â–æ –æ–±'—î–∫—Ç Product –º—ñ—Å—Ç–∏—Ç—å –≤–∫–ª–∞–¥–µ–Ω–∏–π –æ–±'—î–∫—Ç Supplier, –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è product.supplier.id
                document.getElementById('edit-supplierId').value = product.supplier ? product.supplier.id : '';

                // 3. –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ
                openModal('editProductModal');
            })
            .catch(error => {
                displayMessage(error.message, true);
            });
    }

    async function handleUpdateProduct(event) {
        event.preventDefault();
        const form = event.target;
        const productId = document.getElementById('edit-product-id').value;

        // –ó–±–∏—Ä–∞—î–º–æ –¥–∞–Ω—ñ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (Product productDetails)
        const data = {
            name: form.name.value,
            article: form.article.value,
            price: parseFloat(form.price.value),
            minQuantity: parseInt(form.minQuantity.value),
            // –£–≤–∞–≥–∞: —è–∫—â–æ ProductService –æ—á—ñ–∫—É—î –ª–∏—à–µ ID –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç—ñ–ª—å–∫–∏ –π–æ–≥–æ.
            // –û—Å–∫—ñ–ª—å–∫–∏ PUT –ø—Ä–∏–π–º–∞—î Product productDetails, –º–∏ –º–æ–∂–µ–º–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ —Ü–µ –ø–æ–ª–µ.
            supplierId: form.supplierId.value ? parseInt(form.supplierId.value) : null
        };

        try {
            const response = await fetch(`${API_BASE_URL}/products/${productId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É: ' + response.statusText);

            const updatedProduct = await response.json();
            displayMessage(`–¢–æ–≤–∞—Ä "${updatedProduct.name}" —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ.`);
            closeModal('editProductModal');
            loadProducts();
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    // --- –£—Ç–∏–ª—ñ—Ç–∏ —Ç–∞ –ú–æ–¥–∞–ª—å–Ω—ñ –í—ñ–∫–Ω–∞ ---

    function openModal(modalId) {
        document.getElementById(modalId).classList.remove('hidden');
    }

    function closeModal(modalId) {
        document.getElementById(modalId).classList.add('hidden');
    }

    function displayMessage(message, isError = false) {
        // –†–µ–∞–ª—ñ–∑—É–π—Ç–µ —Ç—É—Ç –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (Toast/Alert)
        console.log(isError ? 'ERROR: ' : 'SUCCESS: ', message);
        alert(message);
    }

    // --- API –§—É–Ω–∫—Ü—ñ—ó ---

    // 1. PRODUCTS
    async function loadProducts(lowStockOnly = false) {
        const url = lowStockOnly ? `${API_BASE_URL}/products/low-stock` : `${API_BASE_URL}/products`;
        const listElement = document.getElementById('products-list');
        listElement.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</td></tr>';

        try {
            const response = await fetch(url);
            const products = await response.json();

            listElement.innerHTML = products.map(product => {
                const isLow = product.quantity < product.minQuantity;
                const rowClass = isLow ? 'bg-low-stock' : 'hover:bg-gray-50';
                return `
                        <tr class="${rowClass}">
                            <td class="px-6 py-4 whitespace-nowrap">${product.name}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${product.article}</td>
                            <td class="px-6 py-4 whitespace-nowrap font-bold ${isLow ? 'text-red-600' : 'text-accent'}">${product.quantity}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${product.minQuantity}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <button onclick="openEditProductModal(${product.id})" class="text-blue-600 hover:text-blue-900">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                                <button onclick="deleteProduct(${product.id})" class="text-red-600 hover:text-red-900 ml-3">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                            </td>
                        </tr>
                    `;
            }).join('');
        } catch (error) {
            listElement.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-red-500">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤.</td></tr>';
            console.error('Error loading products:', error);
        }
    }

    async function handleCreateProduct(event) {
        event.preventDefault();
        const form = event.target;
        const userId = getUserId();

        if (!userId) {
            displayMessage('–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å —É —Å–∏—Å—Ç–µ–º—É, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–æ–≤–∞—Ä.', true);
            return;
        }

        const data = {
            name: form.name.value,
            article: form.article.value,
            price: parseFloat(form.price.value),
            supplierId: parseInt(form.supplierId.value),
            minQuantity: form.minQuantity.value ? parseInt(form.minQuantity.value) : 10,
            initialQuantity: form.initialQuantity.value ? parseInt(form.initialQuantity.value) : 0,
            userId: parseInt(userId),
        };

        try {
            const response = await fetch(`${API_BASE_URL}/products`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É: ' + response.statusText);

            const newProduct = await response.json();
            displayMessage(`–¢–æ–≤–∞—Ä "${newProduct.name}" —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ –∑ –ø–æ—á–∞—Ç–∫–æ–≤–∏–º –∑–∞–ø–∞—Å–æ–º.`);
            closeModal('createProductModal');
            form.reset();
            loadProducts();
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    async function deleteProduct(id) {
        if (!confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä –∑ ID: ${id}?`)) return;
        try {
            const response = await fetch(`${API_BASE_URL}/products/${id}`, { method: 'DELETE' });
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É: ' + response.statusText);

            displayMessage(`–¢–æ–≤–∞—Ä ID:${id} —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.`);
            loadProducts();
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    async function searchProductByArticle() {
        const article = document.getElementById('article-search').value.trim();
        if (!article) return alert('–í–≤–µ–¥—ñ—Ç—å –∞—Ä—Ç–∏–∫—É–ª –¥–ª—è –ø–æ—à—É–∫—É.');

        try {
            const response = await fetch(`${API_BASE_URL}/products/search?article=${article}`);
            if (response.status === 404) throw new Error('–¢–æ–≤–∞—Ä –∑ —Ç–∞–∫–∏–º –∞—Ä—Ç–∏–∫—É–ª–æ–º –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.');
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É: ' + response.statusText);

            const product = await response.json();
            // –¢—É—Ç –º–æ–∂–Ω–∞ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ —Ç–æ–≤–∞—Ä —É –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ –∞–±–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é
            alert(`–ó–Ω–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä: ${product.name} (ID: ${product.id}, –ö—ñ–ª—å–∫—ñ—Å—Ç—å: ${product.quantity})`);
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    // 2. MOVEMENTS
    function openMovementModal(type) {
        const titleMap = {
            'arrival': '–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ù–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è',
            'shipment': '–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è',
            'writeoff': '–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –°–ø–∏—Å–∞–Ω–Ω—è'
        };
        const descPlaceholderMap = {
            'arrival': '–û–ø–∏—Å –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è (–ù–∞–ø—Ä–∏–∫–ª–∞–¥, "–í—ñ–¥ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ X")',
            'shipment': '–û–ø–∏—Å –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–ù–∞–ø—Ä–∏–∫–ª–∞–¥, "–ü—Ä–æ–¥–∞–∂ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Ññ123")',
            'writeoff': '–ü—Ä–∏—á–∏–Ω–∞ —Å–ø–∏—Å–∞–Ω–Ω—è (–ù–∞–ø—Ä–∏–∫–ª–∞–¥, "–ü–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—ñ")'
        };

        document.getElementById('movement-modal-title').textContent = titleMap[type];
        document.getElementById('movement-type').value = type;
        document.getElementById('movement-description-input').placeholder = descPlaceholderMap[type];
        // –ó–º—ñ–Ω—é—î–º–æ –∞—Ç—Ä–∏–±—É—Ç name, –æ—Å–∫—ñ–ª—å–∫–∏ writeoff –ø—Ä–∏–π–º–∞—î 'reason', –∞ –Ω–µ 'description'
        document.getElementById('movement-description-input').name = (type === 'writeoff' ? 'reason' : 'description');

        openModal('movementModal');
    }

    async function handleMovement(event) {
        event.preventDefault();
        const form = event.target;
        const type = document.getElementById('movement-type').value;

        const data = {
            productId: parseInt(form.productId.value),
            quantity: parseInt(form.quantity.value),
            userId: parseInt(form.userId.value),
        };
        // –î–æ–¥–∞—î–º–æ –æ–ø–∏—Å/–ø—Ä–∏—á–∏–Ω—É –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–∏–ø—É
        data[form.children[4].name] = form.children[4].value; // –î–∏–Ω–∞–º—ñ—á–Ω–æ –æ—Ç—Ä–∏–º—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –ø–æ–ª—è

        try {
            const response = await fetch(`${API_BASE_URL}/movements/${type}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (!response.ok) throw new Error(`–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó ${type}: ` + response.statusText);

            await response.json();
            displayMessage(`–û–ø–µ—Ä–∞—Ü—ñ—è ${type} —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∞.`);
            closeModal('movementModal');
            form.reset();
            // –ü—ñ—Å–ª—è —Ä—É—Ö—É –º–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä—ñ–≤
            loadProducts();
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    async function loadMovementsByDateRange() {
        const start = document.getElementById('movement-start-date').value;
        const end = document.getElementById('movement-end-date').value;

        if (!start || !end) return alert('–û–±–µ—Ä—ñ—Ç—å –æ–±–∏–¥–≤—ñ –¥–∞—Ç–∏ —Ç–∞ —á–∞—Å.');

        const listElement = document.getElementById('movements-list');
        listElement.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</td></tr>';

        try {
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –µ–Ω–¥–ø–æ—ñ–Ω—Ç GET /api/movements?start=...&end=...
            const response = await fetch(`${API_BASE_URL}/movements?start=${start}:00&end=${end}:00`);
            const movements = await response.json();

            listElement.innerHTML = movements.map(m => {
                const date = new Date(m.date).toLocaleString('uk-UA');
                return `
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">${date}</td>
                            <td class="px-6 py-4 whitespace-nowrap font-semibold">${m.type}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${m.product.id}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${m.quantity}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${m.description || m.reason || '-'}</td>
                        </tr>
                    `;
            }).join('');
        } catch (error) {
            listElement.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-red-500">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä—É—Ö—ñ–≤.</td></tr>';
            console.error('Error loading movements:', error);
        }
    }

    // 3. INVOICES
    async function loadInvoices() {
        const listElement = document.getElementById('invoices-list');
        listElement.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</td></tr>';

        try {
            const response = await fetch(`${API_BASE_URL}/invoices`);
            const invoices = await response.json();

            listElement.innerHTML = invoices.map(invoice => {
                const date = new Date(invoice.date).toLocaleDateString('uk-UA');
                return `
                        <tr class="hover:bg-gray-50 cursor-pointer" onclick="viewInvoiceDetails(${invoice.id})">
                            <td class="px-6 py-4 whitespace-nowrap font-bold">${invoice.id}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${date}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${invoice.contractorId}</td>
                            <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-accent-light text-accent">–ü—Ä–æ–≤–µ–¥–µ–Ω–æ</span></td>
                            <td class="px-6 py-4 whitespace-nowrap"><button class="text-blue-600 hover:text-blue-900">–î–µ—Ç–∞–ª—ñ</button></td>
                        </tr>
                    `;
            }).join('');
        } catch (error) {
            listElement.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-red-500">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö.</td></tr>';
            console.error('Error loading invoices:', error);
        }
    }

    function addShipmentItem() {
        const container = document.getElementById('shipment-items-container');
        const newItemHtml = `
                <div class="flex space-x-2 mt-2">
                    <input type="number" name="productId" placeholder="ID –ü—Ä–æ–¥—É–∫—Ç—É" class="flex-1 p-2 border rounded">
                    <input type="number" name="quantity" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å" class="w-24 p-2 border rounded">
                </div>
            `;
        container.insertAdjacentHTML('beforeend', newItemHtml);
    }

    async function handleProcessShipment(event) {
        event.preventDefault();
        const form = event.target;

        const itemInputs = document.querySelectorAll('#shipment-items-container .flex');
        const items = [];
        itemInputs.forEach(div => {
            const productId = div.querySelector('input[name="productId"]').value;
            const quantity = div.querySelector('input[name="quantity"]').value;
            if (productId && quantity) {
                items.push({
                    productId: parseInt(productId),
                    quantity: parseInt(quantity)
                });
            }
        });

        if (items.length === 0) return alert('–î–æ–¥–∞–π—Ç–µ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä –¥–ª—è –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.');

        const data = {
            contractorId: parseInt(form.contractorId.value),
            userId: parseInt(form.userId.value),
            items: items
        };

        try {
            const response = await fetch(`${API_BASE_URL}/invoices/process-shipment`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: ' + response.statusText);

            const newInvoice = await response.json();
            displayMessage(`–ö–æ–º–ø–ª–µ–∫—Å–Ω–µ –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ. –°—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞–∫–ª–∞–¥–Ω—É ID: ${newInvoice.id}`);
            closeModal('shipmentRequestModal');
            form.reset();
            // –ü—ñ—Å–ª—è –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö —Ç–∞ —Ç–æ–≤–∞—Ä—ñ–≤
            loadInvoices();
            loadProducts();
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    function viewInvoiceDetails(id) {
        // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ GET /api/invoices/{id}
        fetch(`${API_BASE_URL}/invoices/${id}`)
            .then(res => res.json())
            .then(invoice => {
                let details = `–ù–∞–∫–ª–∞–¥–Ω–∞ ID: ${invoice.id}\n–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: ${invoice.contractorId}\n\n`;
                details += "–¢–æ–≤–∞—Ä–∏:\n";
                // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ –æ–±'—î–∫—Ç Invoice –º–∞—î –ø–æ–ª–µ 'items'
                if (invoice.items) {
                    invoice.items.forEach(item => {
                        details += ` - –ü—Ä–æ–¥—É–∫—Ç ID ${item.productId}, –ö—ñ–ª—å–∫—ñ—Å—Ç—å: ${item.quantity}\n`;
                    });
                } else {
                    details += "–î–µ—Ç–∞–ª—ñ —Ç–æ–≤–∞—Ä—ñ–≤ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ.";
                }
                alert(details);
            })
            .catch(err => displayMessage('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–µ—Ç–∞–ª–µ–π –Ω–∞–∫–ª–∞–¥–Ω–æ—ó.', true));
    }

    // 4. NOTIFICATIONS
    async function loadUnreadCount() {
        try {
            const response = await fetch(`${API_BASE_URL}/notifications/unread`);
            const notifications = await response.json();
            document.getElementById('unread-count').textContent = notifications.length;
            if (notifications.length > 0) {
                document.getElementById('unread-count').classList.add('bg-red-600');
            } else {
                document.getElementById('unread-count').classList.remove('bg-red-600');
            }
        } catch (error) {
            console.error('Error loading unread notifications count:', error);
        }
    }

    function showNotifications() {
        // –ü–µ—Ä–µ–∫–ª—é—á–∞—î–º–æ—Å—å –Ω–∞ —Å–µ–∫—Ü—ñ—é —Å–ø–æ–≤—ñ—â–µ–Ω—å
        document.querySelector(`.nav-link[data-section="notifications"]`).click();
    }

    async function loadNotifications() {
        const listElement = document.getElementById('notifications-list');
        listElement.innerHTML = '<li>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</li>';

        try {
            const response = await fetch(`${API_BASE_URL}/notifications`);
            const notifications = await response.json();

            listElement.innerHTML = notifications.map(n => {
                const isRead = n.isRead; // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ —î –ø–æ–ª–µ isRead
                const statusClass = isRead ? 'text-gray-500' : 'text-gray-800 font-semibold';
                const icon = isRead ? '‚úÖ' : 'üîî';

                return `
                        <li class="p-3 ${isRead ? 'bg-gray-50' : 'bg-white'} hover:bg-gray-100 flex justify-between items-center">
                            <div class="${statusClass}">
                                ${icon} ${n.message}
                                <span class="text-xs text-gray-400 ml-2">${new Date(n.date).toLocaleString('uk-UA')}</span>
                            </div>
                            ${!isRead ? `<button onclick="markAsRead(${n.id})" class="text-blue-600 hover:text-blue-800 text-sm">–ü–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–µ</button>` : ''}
                        </li>
                    `;
            }).join('');

        } catch (error) {
            listElement.innerHTML = '<li class="p-3 text-center text-red-500">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å.</li>';
            console.error('Error loading notifications:', error);
        }
    }

    async function markAsRead(id) {
        try {
            const response = await fetch(`${API_BASE_URL}/notifications/${id}/read`, { method: 'PUT' });
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞: –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–µ.');

            displayMessage(`–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è ID:${id} –ø–æ–∑–Ω–∞—á–µ–Ω–æ —è–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–µ.`);
            loadNotifications();
            loadUnreadCount(); // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫
        } catch (error) {
            displayMessage(error.message, true);
        }
    }

    // 5. REPORTS
    async function loadReport(reportType) {
        const outputElement = document.getElementById('report-output');
        outputElement.textContent = `–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–≤—ñ—Ç—É ${reportType}...`;

        let url = `${API_BASE_URL}/reports/${reportType}`;

        if (reportType === 'movement-dynamics') {
            // –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–∞—Ç, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –∫–Ω–æ–ø–æ–∫
            url += '?start=2024-01-01T00:00:00&end=2024-12-31T23:59:59'; // Example dates
        }

        try {
            const response = await fetch(url);
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–≤—ñ—Ç—É: ' + response.statusText);

            const report = await response.json();
            // –ö—Ä–∞—Å–∏–≤–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è JSON –∑–≤—ñ—Ç—É
            outputElement.textContent = JSON.stringify(report, null, 2);
        } catch (error) {
            outputElement.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
        }
    }

    async function loadSuppliers() {
        const listElement = document.getElementById('suppliers-list');
        listElement.innerHTML = '<tr><td colspan="3" class="p-4 text-center text-gray-500">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</td></tr>';

        try {
            const response = await fetch(`${API_BASE_URL}/suppliers`);
            const suppliers = await response.json();

            listElement.innerHTML = suppliers.map(supplier => {
                return `
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 whitespace-nowrap font-bold">${supplier.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${supplier.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${supplier.contactPerson || supplier.email || supplier.phone || '-'}</td>
                </tr>
            `;
            }).join('');

            if (suppliers.length === 0) {
                listElement.innerHTML = '<tr><td colspan="3" class="p-4 text-center text-gray-500">–ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</td></tr>';
            }

        } catch (error) {
            listElement.innerHTML = '<tr><td colspan="3" class="p-4 text-center text-red-500">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤.</td></tr>';
            console.error('Error loading suppliers:', error);
        }
    }

    async function handleCreateSupplier(event) {
        event.preventDefault();
        const form = event.target;

        // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ SupplierDTO –º–∞—î –ø–æ–ª—è name, contactPerson, email, phone
        const data = {
            name: form.name.value,
            contactPerson: form.contactPerson.value,
            email: form.email.value,
            phone: form.phone.value,
        };

        try {
            const response = await fetch(`${API_BASE_URL}/suppliers`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞: ${response.status} - ${errorText}`);
            }

            const newSupplier = await response.json();
            displayMessage(`–ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫ "${newSupplier.name}" —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–∏–π.`);
            closeModal('createSupplierModal');
            form.reset();
            loadSuppliers(); // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫
        } catch (error) {
            displayMessage(error.message, true);
            console.error('Error creating supplier:', error);
        }
    }

    async function handleGenerateReport(event) {
        event.preventDefault();
        const form = event.target;
        const outputElement = document.getElementById('report-output');
        outputElement.textContent = `–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∑–≤—ñ—Ç—É...`;

        const data = {
            reportType: form.reportType.value,
            startDate: form.startDate.value ? form.startDate.value + ':00' : null,
            endDate: form.endDate.value ? form.endDate.value + ':00' : null,
        };

        try {
            const response = await fetch(`${API_BASE_URL}/reports/generate`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∑–≤—ñ—Ç—É: ' + response.statusText);

            const report = await response.json();
            displayMessage(`–ó–≤—ñ—Ç ${data.reportType} —É—Å–ø—ñ—à–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ.`);
            outputElement.textContent = JSON.stringify(report, null, 2);
            closeModal('reportGeneratorModal');
            form.reset();
        } catch (error) {
            outputElement.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            displayMessage(error.message, true);
        }
    }

</script>
</body>
</html>